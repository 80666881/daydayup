<html>
<body>
<script>

//有向无环图
var pages = []

//开始结点有两个后继
pages["welecome"] = [];
pages["welecome"]["nextNode"] = [];
pages["welecome"]["nextNode"][0] = "extender"
pages["welecome"]["nextNode"][1] = "workmode"
pages["welecome"]["isBeginning"] = true; 

//第一个后继就是终点
pages["extender"] = [];
pages["extender"]["nextNode"] = [];

//另外一个后继又有两个后继
pages["workmode"] = [];
pages["workmode"]["nextNode"] = [];
pages["workmode"]["nextNode"][0] = "WAN"
pages["workmode"]["nextNode"][1] = "WLAN"

//WAN的后继为WLAN
pages["WAN"] = [];
pages["WAN"]["nextNode"] = [];
pages["WAN"]["nextNode"][0] = "WLAN"

//WLAN的后继为终点
pages["WLAN"] = [];
pages["WLAN"]["nextNode"] = [];
pages["WLAN"]["nextNode"][0] = "OVER"

pages["OVER"] = [];
pages["OVER"]["nextNode"] = [];

//判断两个节点是否有前后继关系，第一个为前，后一个为后
function isSuccessor(pName, pNameSucc)
{
	var page = pages[pName];
	var nextNodes = page["nextNode"];
	for ( var index in nextNodes )
	{
		var nextNode = nextNodes[index];
		if ( nextNode == pNameSucc )
		{
			return true;
		}
	}
	
	return false;
}

//初始化图的权重矩阵
document.write("------------ initialize edge weight START -------------------</br>")
var edgeWeight = [];
for ( var pName in pages )
{
    document.write("------------ initialize page "+pName+" -------------------</br>")

	edgeWeight[pName] = [];
	for ( var pNameA in pages )
	{
		var isSucc = isSuccessor(pName, pNameA);
		if ( true == isSucc )
		{
			edgeWeight[pName][pNameA] = 1;
		}
		else
		{
			edgeWeight[pName][pNameA] = Number.POSITIVE_INFINITY;
		}
		document.write("pName="+pName+"|pNameA="+pNameA+"|edgeWeight="+edgeWeight[pName][pNameA]+"</br>")
	}
}
document.write("------------ initialize edge weight END-------------------</br></br></br>")


/* 已经知道最短路径集合 */
var knownSet = []

/* 未知最短路径集合 */
var unKnownSet = []

//初始化，出发点添加到已知集合，其他添加到未知集合
for ( var pName in pages )
{
	var isBegin = pages[pName]["isBeginning"];
	if ( true == isBegin )
	{
		knownSet.push(pName);
	}
	else
	{
		unKnownSet.push(pName);
	}
}

/* 最短特殊路径长度 */
var distanceSP = [];
var pNameStart = knownSet[0];
for ( var index in unKnownSet )
{
	var pName = unKnownSet[index];
	distanceSP[pName] = edgeWeight[pNameStart][pName];
	console.log("pNameStart="+pNameStart+"|pName="+pName+"|distanceSP="+distanceSP[pName]
}

/* dijstra */
var loopNum = unKnownSet.length;
for ( var i=0; i<loopNum; i++ )
{
	/* 找unKnownSet中最短特殊路径顶点 */
	var minDistPName = unKnownSet[0]; 
	var minDistIndex = 0;
	var minDist = distanceSP[minDistPName]
	for ( var index in unKnownSet )
	{
		var pName = unKnownSet[index];
		var dist = distanceSP[pName];
		if ( dist < minDist )
		{
			minDist = dist;
			minDistPName = pName;
			minDistIndex = index;
		}
	}
	
	/* 将最短特殊路径顶点，从unkownSet中删除，加入knownSet */
	unKnownSet.splice(minDistIndex, 1);
	knownSet.push(minDistPName);
	
	/* 更新 unKnownSet 中元素的 distanceSP 值得 */
	for ( var index in unKnownSet )
	{
		var pName = unKnownSet[index];
		var oldDist = distanceSP[pName];
		var weight = edgeWeight[minDistPName][pName];
		var newDist = minDist + weight;
		if ( newDist < oldDist )
		{
			distanceSP[pName] = newDist;
		}
	}
}

/* 输出看打印结果 */
for ( var index in knownSet )
{
	var pName = knownSet[index];
	document.write("pName="+pName+"|shortPath="+distanceSP[pName]+"<br/>");
}

</script>
</body>
</html>